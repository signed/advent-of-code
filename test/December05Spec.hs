module December05Spec where
import Test.Hspec
import Data.Char(digitToInt)
import December05


challenge = "1\n\
             \0\n\
             \2\n\
             \-1\n\
             \1\n\
             \-4\n\
             \-4\n\
             \-5\n\
             \-2\n\
             \-1\n\
             \-4\n\
             \-8\n\
             \-8\n\
             \-1\n\
             \-6\n\
             \-9\n\
             \-3\n\
             \-14\n\
             \-6\n\
             \2\n\
             \-15\n\
             \-9\n\
             \-5\n\
             \-9\n\
             \-14\n\
             \-4\n\
             \-3\n\
             \-23\n\
             \-24\n\
             \2\n\
             \-24\n\
             \-22\n\
             \-31\n\
             \-23\n\
             \-5\n\
             \1\n\
             \-35\n\
             \-11\n\
             \0\n\
             \-30\n\
             \-18\n\
             \-25\n\
             \-24\n\
             \2\n\
             \-35\n\
             \-33\n\
             \-29\n\
             \-2\n\
             \-27\n\
             \-44\n\
             \-19\n\
             \-19\n\
             \-40\n\
             \-52\n\
             \-26\n\
             \-20\n\
             \-37\n\
             \1\n\
             \-40\n\
             \-36\n\
             \-29\n\
             \-37\n\
             \-56\n\
             \-59\n\
             \-34\n\
             \-31\n\
             \-17\n\
             \-24\n\
             \-14\n\
             \-57\n\
             \-16\n\
             \-68\n\
             \-27\n\
             \-60\n\
             \-73\n\
             \-16\n\
             \-60\n\
             \-6\n\
             \-45\n\
             \-38\n\
             \-48\n\
             \-33\n\
             \-68\n\
             \-12\n\
             \-51\n\
             \-49\n\
             \-10\n\
             \-28\n\
             \-66\n\
             \-88\n\
             \-8\n\
             \-83\n\
             \-5\n\
             \-2\n\
             \-39\n\
             \-39\n\
             \-12\n\
             \-87\n\
             \-63\n\
             \-55\n\
             \-55\n\
             \-26\n\
             \-5\n\
             \1\n\
             \-68\n\
             \-100\n\
             \-98\n\
             \-71\n\
             \-15\n\
             \-96\n\
             \-100\n\
             \-107\n\
             \-45\n\
             \-46\n\
             \-3\n\
             \-13\n\
             \-25\n\
             \-110\n\
             \-63\n\
             \-84\n\
             \2\n\
             \-107\n\
             \-11\n\
             \-50\n\
             \-8\n\
             \-55\n\
             \-96\n\
             \-76\n\
             \-26\n\
             \-103\n\
             \-42\n\
             \-43\n\
             \-94\n\
             \-31\n\
             \-112\n\
             \-64\n\
             \-72\n\
             \-95\n\
             \-20\n\
             \-51\n\
             \-27\n\
             \-129\n\
             \-108\n\
             \-75\n\
             \-92\n\
             \-18\n\
             \-18\n\
             \-68\n\
             \-43\n\
             \-71\n\
             \-59\n\
             \-70\n\
             \-122\n\
             \-64\n\
             \-39\n\
             \-146\n\
             \-134\n\
             \-120\n\
             \-3\n\
             \-137\n\
             \-88\n\
             \-93\n\
             \-155\n\
             \-66\n\
             \-34\n\
             \-85\n\
             \-142\n\
             \-55\n\
             \-141\n\
             \-5\n\
             \-74\n\
             \-110\n\
             \-32\n\
             \-148\n\
             \-90\n\
             \-108\n\
             \-9\n\
             \-75\n\
             \-55\n\
             \-64\n\
             \-14\n\
             \-5\n\
             \-131\n\
             \-31\n\
             \-119\n\
             \-115\n\
             \-170\n\
             \-110\n\
             \-52\n\
             \-187\n\
             \-44\n\
             \-169\n\
             \-53\n\
             \-154\n\
             \-79\n\
             \-48\n\
             \-26\n\
             \-175\n\
             \-153\n\
             \-198\n\
             \-139\n\
             \-119\n\
             \-119\n\
             \-93\n\
             \-80\n\
             \-101\n\
             \-65\n\
             \-112\n\
             \-186\n\
             \-1\n\
             \-171\n\
             \-71\n\
             \-209\n\
             \-76\n\
             \-121\n\
             \-104\n\
             \-159\n\
             \-91\n\
             \-54\n\
             \-6\n\
             \-18\n\
             \-196\n\
             \-40\n\
             \-155\n\
             \-103\n\
             \-98\n\
             \-191\n\
             \-66\n\
             \-83\n\
             \-206\n\
             \-142\n\
             \-118\n\
             \-211\n\
             \-216\n\
             \-141\n\
             \-197\n\
             \-131\n\
             \-77\n\
             \-46\n\
             \-110\n\
             \-124\n\
             \-56\n\
             \-165\n\
             \-183\n\
             \-94\n\
             \-87\n\
             \-55\n\
             \-110\n\
             \-208\n\
             \-37\n\
             \-99\n\
             \-63\n\
             \-86\n\
             \-197\n\
             \-176\n\
             \-235\n\
             \-202\n\
             \-131\n\
             \-49\n\
             \-22\n\
             \-247\n\
             \-253\n\
             \-256\n\
             \-114\n\
             \-49\n\
             \-126\n\
             \-104\n\
             \-105\n\
             \-87\n\
             \-230\n\
             \-61\n\
             \-83\n\
             \-24\n\
             \-196\n\
             \-31\n\
             \-267\n\
             \-118\n\
             \-139\n\
             \-83\n\
             \-45\n\
             \-251\n\
             \-84\n\
             \-187\n\
             \-104\n\
             \-192\n\
             \-224\n\
             \-145\n\
             \-219\n\
             \-266\n\
             \-62\n\
             \-27\n\
             \-255\n\
             \-2\n\
             \-117\n\
             \-240\n\
             \-199\n\
             \-295\n\
             \-177\n\
             \-185\n\
             \-245\n\
             \-29\n\
             \-47\n\
             \-55\n\
             \-64\n\
             \-147\n\
             \-154\n\
             \-217\n\
             \-211\n\
             \-291\n\
             \-254\n\
             \-44\n\
             \-103\n\
             \-271\n\
             \-37\n\
             \-244\n\
             \-313\n\
             \-200\n\
             \-34\n\
             \-197\n\
             \-72\n\
             \-309\n\
             \-124\n\
             \-134\n\
             \-9\n\
             \-244\n\
             \-254\n\
             \-160\n\
             \-5\n\
             \-84\n\
             \-28\n\
             \-26\n\
             \-162\n\
             \-261\n\
             \-102\n\
             \-85\n\
             \-305\n\
             \-38\n\
             \-54\n\
             \-57\n\
             \-320\n\
             \-94\n\
             \-13\n\
             \-92\n\
             \-34\n\
             \-114\n\
             \-194\n\
             \-128\n\
             \-220\n\
             \-259\n\
             \-298\n\
             \-76\n\
             \-31\n\
             \-185\n\
             \-212\n\
             \-10\n\
             \-7\n\
             \-329\n\
             \-80\n\
             \-135\n\
             \-278\n\
             \-264\n\
             \-322\n\
             \-82\n\
             \-3\n\
             \-9\n\
             \-334\n\
             \-89\n\
             \-217\n\
             \-56\n\
             \-99\n\
             \-16\n\
             \-103\n\
             \-167\n\
             \-148\n\
             \-41\n\
             \-311\n\
             \-125\n\
             \0\n\
             \-135\n\
             \-252\n\
             \-288\n\
             \-293\n\
             \-18\n\
             \-19\n\
             \-358\n\
             \-186\n\
             \-117\n\
             \-65\n\
             \-170\n\
             \-34\n\
             \-256\n\
             \-376\n\
             \-81\n\
             \-106\n\
             \-92\n\
             \-389\n\
             \-147\n\
             \-203\n\
             \-335\n\
             \-320\n\
             \-240\n\
             \-373\n\
             \-337\n\
             \-239\n\
             \-7\n\
             \-214\n\
             \-292\n\
             \-55\n\
             \-388\n\
             \-143\n\
             \-251\n\
             \-111\n\
             \-240\n\
             \-259\n\
             \-187\n\
             \-278\n\
             \-9\n\
             \-312\n\
             \-336\n\
             \-382\n\
             \-226\n\
             \-203\n\
             \-318\n\
             \-277\n\
             \-142\n\
             \-65\n\
             \-80\n\
             \-237\n\
             \-347\n\
             \-92\n\
             \-166\n\
             \-322\n\
             \-306\n\
             \-289\n\
             \-64\n\
             \-53\n\
             \-162\n\
             \-16\n\
             \-357\n\
             \-395\n\
             \-57\n\
             \-409\n\
             \-225\n\
             \-10\n\
             \-169\n\
             \-232\n\
             \-326\n\
             \-219\n\
             \-59\n\
             \-173\n\
             \-315\n\
             \-420\n\
             \-432\n\
             \-100\n\
             \-434\n\
             \-426\n\
             \-160\n\
             \-450\n\
             \-394\n\
             \-145\n\
             \-146\n\
             \-42\n\
             \-320\n\
             \-296\n\
             \-150\n\
             \-159\n\
             \-129\n\
             \-62\n\
             \-345\n\
             \-99\n\
             \-378\n\
             \-234\n\
             \-144\n\
             \-323\n\
             \-378\n\
             \-202\n\
             \-181\n\
             \-334\n\
             \-135\n\
             \-446\n\
             \-295\n\
             \-290\n\
             \-202\n\
             \-366\n\
             \-333\n\
             \-322\n\
             \-311\n\
             \-439\n\
             \-180\n\
             \-319\n\
             \-264\n\
             \-467\n\
             \-397\n\
             \-411\n\
             \-177\n\
             \-235\n\
             \-280\n\
             \-220\n\
             \-371\n\
             \-379\n\
             \-270\n\
             \-157\n\
             \-75\n\
             \-5\n\
             \-82\n\
             \-137\n\
             \-161\n\
             \-17\n\
             \-423\n\
             \-216\n\
             \-10\n\
             \-189\n\
             \-278\n\
             \-467\n\
             \-506\n\
             \-118\n\
             \-435\n\
             \-468\n\
             \-357\n\
             \-169\n\
             \-333\n\
             \-32\n\
             \-266\n\
             \-85\n\
             \-515\n\
             \-76\n\
             \-80\n\
             \-442\n\
             \-190\n\
             \-199\n\
             \-173\n\
             \-264\n\
             \-314\n\
             \-46\n\
             \-360\n\
             \-384\n\
             \-140\n\
             \-213\n\
             \-32\n\
             \-345\n\
             \-367\n\
             \-179\n\
             \-295\n\
             \-1\n\
             \-8\n\
             \-520\n\
             \-300\n\
             \-229\n\
             \-538\n\
             \-488\n\
             \-291\n\
             \-234\n\
             \-159\n\
             \-384\n\
             \-318\n\
             \-257\n\
             \-379\n\
             \-263\n\
             \-495\n\
             \-77\n\
             \-227\n\
             \-108\n\
             \-20\n\
             \-515\n\
             \-293\n\
             \-475\n\
             \-127\n\
             \-247\n\
             \-467\n\
             \-10\n\
             \-29\n\
             \-539\n\
             \-233\n\
             \-461\n\
             \-347\n\
             \-512\n\
             \-339\n\
             \-298\n\
             \-419\n\
             \-252\n\
             \-333\n\
             \-515\n\
             \-203\n\
             \-104\n\
             \-56\n\
             \-456\n\
             \-101\n\
             \-101\n\
             \-68\n\
             \-235\n\
             \-188\n\
             \-522\n\
             \-558\n\
             \-151\n\
             \-337\n\
             \-572\n\
             \-47\n\
             \-411\n\
             \-177\n\
             \-172\n\
             \-178\n\
             \-527\n\
             \-357\n\
             \-192\n\
             \-342\n\
             \-516\n\
             \-215\n\
             \-453\n\
             \-183\n\
             \-144\n\
             \-13\n\
             \-417\n\
             \1\n\
             \-537\n\
             \-588\n\
             \-512\n\
             \-450\n\
             \-343\n\
             \-383\n\
             \-167\n\
             \-342\n\
             \-235\n\
             \-394\n\
             \-227\n\
             \-580\n\
             \-226\n\
             \-437\n\
             \-314\n\
             \-460\n\
             \-279\n\
             \-7\n\
             \-157\n\
             \-125\n\
             \-520\n\
             \-208\n\
             \-69\n\
             \-308\n\
             \-9\n\
             \-554\n\
             \-628\n\
             \-556\n\
             \-329\n\
             \-60\n\
             \-3\n\
             \-378\n\
             \-188\n\
             \-498\n\
             \-600\n\
             \-639\n\
             \-52\n\
             \-577\n\
             \-332\n\
             \-600\n\
             \-119\n\
             \-572\n\
             \-261\n\
             \-58\n\
             \-542\n\
             \-115\n\
             \-328\n\
             \-15\n\
             \-411\n\
             \-19\n\
             \-56\n\
             \-417\n\
             \-332\n\
             \-449\n\
             \-629\n\
             \-440\n\
             \-523\n\
             \-284\n\
             \-304\n\
             \-302\n\
             \-71\n\
             \-87\n\
             \-197\n\
             \-160\n\
             \-461\n\
             \-348\n\
             \-339\n\
             \-367\n\
             \-87\n\
             \-352\n\
             \-232\n\
             \-598\n\
             \-441\n\
             \-660\n\
             \-332\n\
             \-228\n\
             \-676\n\
             \-387\n\
             \-240\n\
             \-222\n\
             \-62\n\
             \-581\n\
             \-102\n\
             \-63\n\
             \-589\n\
             \-37\n\
             \-427\n\
             \-238\n\
             \-687\n\
             \-67\n\
             \-315\n\
             \-408\n\
             \-685\n\
             \-6\n\
             \-664\n\
             \-64\n\
             \-515\n\
             \0\n\
             \-606\n\
             \-494\n\
             \-465\n\
             \-73\n\
             \-79\n\
             \-553\n\
             \-86\n\
             \-513\n\
             \-699\n\
             \-8\n\
             \-485\n\
             \-376\n\
             \-659\n\
             \-214\n\
             \-632\n\
             \-694\n\
             \-370\n\
             \-35\n\
             \-639\n\
             \-373\n\
             \0\n\
             \-584\n\
             \-538\n\
             \-69\n\
             \-293\n\
             \-500\n\
             \-537\n\
             \-476\n\
             \-578\n\
             \-566\n\
             \-123\n\
             \-464\n\
             \-321\n\
             \-434\n\
             \-238\n\
             \-651\n\
             \-61\n\
             \-69\n\
             \-207\n\
             \-297\n\
             \-537\n\
             \-456\n\
             \-122\n\
             \-80\n\
             \-517\n\
             \-581\n\
             \-411\n\
             \-418\n\
             \-734\n\
             \-536\n\
             \-278\n\
             \-92\n\
             \-416\n\
             \-573\n\
             \-308\n\
             \-302\n\
             \-645\n\
             \-555\n\
             \-314\n\
             \-33\n\
             \-715\n\
             \-484\n\
             \-89\n\
             \-746\n\
             \-254\n\
             \-334\n\
             \-509\n\
             \-651\n\
             \-556\n\
             \-615\n\
             \-447\n\
             \-239\n\
             \-545\n\
             \-173\n\
             \-4\n\
             \-390\n\
             \-526\n\
             \-252\n\
             \-654\n\
             \-747\n\
             \-313\n\
             \-430\n\
             \-625\n\
             \-625\n\
             \-578\n\
             \-407\n\
             \-28\n\
             \-113\n\
             \-54\n\
             \-404\n\
             \-671\n\
             \-483\n\
             \-801\n\
             \-530\n\
             \-191\n\
             \-41\n\
             \-694\n\
             \-209\n\
             \-158\n\
             \-49\n\
             \-608\n\
             \-43\n\
             \-34\n\
             \-710\n\
             \-96\n\
             \-417\n\
             \-297\n\
             \-553\n\
             \-310\n\
             \-206\n\
             \-634\n\
             \-419\n\
             \-795\n\
             \-104\n\
             \-91\n\
             \-687\n\
             \-105\n\
             \-248\n\
             \-693\n\
             \-286\n\
             \-63\n\
             \-33\n\
             \-199\n\
             \-68\n\
             \-248\n\
             \-297\n\
             \-281\n\
             \-692\n\
             \-654\n\
             \-521\n\
             \-240\n\
             \-432\n\
             \-515\n\
             \-58\n\
             \-711\n\
             \-671\n\
             \-433\n\
             \-357\n\
             \-228\n\
             \-531\n\
             \-457\n\
             \-269\n\
             \-76\n\
             \-428\n\
             \-590\n\
             \-533\n\
             \-787\n\
             \-833\n\
             \-453\n\
             \-199\n\
             \-113\n\
             \-274\n\
             \-144\n\
             \-495\n\
             \-481\n\
             \-727\n\
             \-356\n\
             \-164\n\
             \-711\n\
             \-143\n\
             \-503\n\
             \-702\n\
             \-783\n\
             \-858\n\
             \-494\n\
             \-114\n\
             \-18\n\
             \-615\n\
             \-243\n\
             \-306\n\
             \-312\n\
             \-378\n\
             \-823\n\
             \-689\n\
             \-119\n\
             \-228\n\
             \-769\n\
             \-508\n\
             \-298\n\
             \-77\n\
             \-465\n\
             \-447\n\
             \-348\n\
             \-392\n\
             \-751\n\
             \-642\n\
             \-841\n\
             \-654\n\
             \-617\n\
             \-119\n\
             \-490\n\
             \-139\n\
             \-359\n\
             \-58\n\
             \-34\n\
             \-554\n\
             \-168\n\
             \-675\n\
             \-104\n\
             \-772\n\
             \-232\n\
             \-124\n\
             \-460\n\
             \-815\n\
             \-856\n\
             \-260\n\
             \-3\n\
             \-303\n\
             \-771\n\
             \-398\n\
             \-282\n\
             \-353\n\
             \-192\n\
             \-227\n\
             \-645\n\
             \-598\n\
             \-345\n\
             \-197\n\
             \-881\n\
             \-242\n\
             \-159\n\
             \-693\n\
             \-537\n\
             \-887\n\
             \-44\n\
             \-302\n\
             \-252\n\
             \-496\n\
             \-590\n\
             \-126\n\
             \-883\n\
             \-301\n\
             \-697\n\
             \-439\n\
             \-928\n\
             \-69\n\
             \-192\n\
             \-30\n\
             \-273\n\
             \-944\n\
             \-606\n\
             \-319\n\
             \-638\n\
             \-319\n\
             \-391\n\
             \-573\n\
             \-268\n\
             \-231\n\
             \-649\n\
             \-781\n\
             \-936\n\
             \-434\n\
             \-435\n\
             \-287\n\
             \-282\n\
             \-778\n\
             \-608\n\
             \-844\n\
             \-708\n\
             \-26\n\
             \-162\n\
             \-697\n\
             \-168\n\
             \-280\n\
             \-472\n\
             \-96\n\
             \-470\n\
             \-334\n\
             \-38\n\
             \-739\n\
             \-936\n\
             \-655\n\
             \-946\n\
             \-599\n\
             \-562\n\
             \-12\n\
             \-912\n\
             \-406\n\
             \-532\n\
             \-458\n\
             \-828\n\
             \-764\n\
             \-314\n\
             \-880\n\
             \-897\n\
             \-499\n\
             \-412\n\
             \-774\n\
             \-249\n\
             \-579\n\
             \-294\n\
             \-883\n\
             \-558\n\
             \-963\n\
             \-228\n\
             \-775\n\
             \-205\n\
             \-515\n\
             \-662\n\
             \-335\n\
             \-926\n\
             \-2\n\
             \-865\n\
             \-763\n\
             \-23\n\
             \-543\n\
             \-715\n\
             \-243\n\
             \-343\n\
             \-176\n\
             \-68\n\
             \-326\n\
             \-926\n\
             \-481\n\
             \-517\n\
             \-517\n\
             \-885\n\
             \-238\n\
             \-400\n\
             \-560\n\
             \-390\n\
             \-96\n\
             \-285\n\
             \-213\n\
             \-680\n\
             \-221\n\
             \-856\n\
             \-451\n\
             \-33\n\
             \-391\n\
             \-589\n\
             \-443\n\
             \-695\n\
             \-276\n\
             \-415\n\
             \-362\n\
             \-789\n\
             \-909\n\
             \-905\n\
             \-71\n\
             \-919\n\
             \-644\n\
             \-237\n\
             \-239\n\
             \-458\n\
             \-705"

toIntList :: [String] -> [Int]
toIntList x = map read x

spec :: Spec
spec =
  describe "steps till exit" $ do
    it "challenge" $ do
       let jumps = toIntList $ lines challenge
       stepsToExit jumps `shouldBe` 372671
    it "challenge part two" $ do
       let jumps = toIntList $ lines challenge
       pendingWith "runs too long"
       stepsToExitPartTwo jumps `shouldBe` 25608480
    it "acceptance" $ do
       let jumps = [0, 3, 0, 1, -3]
       stepsToExit jumps `shouldBe` 5
    it "acceptance part two" $ do
       let jumps = [0, 3, 0, 1, -3]
       stepsToExitPartTwo jumps `shouldBe` 10
    it "one jump command" $ do
       let jumps = [1]
       stepsToExit jumps `shouldBe` 1
    it "one two command" $ do
       let jumps = [0]
       stepsToExit jumps `shouldBe` 2
